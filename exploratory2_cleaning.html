<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title></title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.0.13/css/fa-svg-with-js.css" rel="stylesheet" />
<script src="site_libs/font-awesome-5.0.13/js/fontawesome-all.min.js"></script>
<script src="site_libs/font-awesome-5.0.13/js/fa-v4-shims.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4,h5",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Exploratory Data Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="exploratory1.html">Exploring Activity Trends and Patterns Using EDA</a>
    </li>
    <li>
      <a href="exploratory2.html">Exploring NYC Crime Data Using EDA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data Analysis - R
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="ordinalmodel.html">Analyzing Likert Scale of Depressive Symptoms</a>
    </li>
    <li>
      <a href="felonies.html">Differences in Mean Length of NYC Felonies</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Data Analysis - SAS
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="NHANES1.html">Alcohol and Smoking Using NHANES</a>
    </li>
    <li>
      <a href="NHANES2.html">Away-From-Home Meals and BMI</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    SQL Queries
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="sql.html">SQL Queries With NHANES Data </a>
    </li>
    <li>
      <a href="sql2.html">SQL Queries With Cancer Data </a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Biostatistics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="survival.html">Survival Analysis of Stroke Patients</a>
    </li>
    <li>
      <a href="malaria.html">Proposal for Phase III RCT</a>
    </li>
  </ul>
</li>
<li>
  <a href="resume.html">Resume</a>
</li>
<li>
  <a href="mailto:&lt;jmc2392@cumc.columbia.edu&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://github.com/jmc2392/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<p><br></p>
<style>
.list-group-item.active, .list-group-item.active:focus, .list-group-item.active:hover {
    background-color: #337ab7;
}

.navbar-default .navbar-collapse, .navbar-default .navbar-form {
background-color: #337ab7;
}

#Drop-Down Menu Color
.navbar-default .navbar-nav>.open>a, .navbar-default .navbar-nav>.open>a:focus, .navbar-default .navbar-nav>.open>a:hover {
background-color: #337ab7;
}

.navbar-default {
background-color: #337ab7;
}

.navbar-default .navbar-nav>li>a {
color: white;
font-weight: bold;
}

.navbar-default .navbar-brand {
color: white;
font-weight: bold;
}

</style>
<script>
$(document).ready(function() {
  $items = $('div#TOC li');
  $items.each(function(idx) {
    num_ul = $(this).parentsUntil('#TOC').length;
    $(this).css({'text-indent': num_ul * 10, 'padding-left': 0});
  });

});
</script>
<div id="exploring-nyc-crime-data-using-eda---cleaning-data" class="section level2">
<h2>Exploring NYC Crime Data Using EDA - Cleaning Data</h2>
<p><br></p>
<div id="importing-data" class="section level3">
<h3>Importing Data</h3>
<p>Below, we include the code we used to import and clean the data for the “Exploring NYC Crime Data Using EDA” project:</p>
<pre class="r"><code>library(RSocrata)</code></pre>
<pre><code>## Warning: package &#39;RSocrata&#39; was built under R version 3.5.3</code></pre>
<pre class="r"><code>library(tidyverse)
library(lubridate)</code></pre>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     date</code></pre>
<pre class="r"><code>nyc_crime &lt;- read_csv(&quot;./data/NYPD_Complaint_Data_Historic.csv&quot;)

#Code for importing directly from web:
#nyc_crime = read.socrata(&quot;https://data.cityofnewyork.us/resource/9s4h-37hy.json&quot;, 
#                          app_token = NULL, 
#                          email = NULL, 
#                          password = NULL,
#                          stringsAsFactors = FALSE)

#saveRDS(nyc_crime, file = &quot;./data/nyc_crime.rds&quot;)</code></pre>
<p>The raw, acquired dataset has 6,036,805 observations and 35 variables. Broadly speaking, the variables contain information on the exact date, time and location of crime, description of crime, demographic information of the victim and suspect, and police department infromation. For more information on the variables, click <a href="https://data.cityofnewyork.us/Public-Safety/NYPD-Complaint-Data-Historic/qgea-i56i">here</a>.</p>
<p><br></p>
</div>
<div id="penal-codes" class="section level3">
<h3>Penal Codes</h3>
<p>We were interested in sex-related, weapon-related and drug-related felonies occurring in NYC from 2014 - 2017. Below is a list of the penal codes associated with each type of felony.</p>
<p><br></p>
<div id="sexrelated-felonies" class="section level4">
<h4>Sex–Related Felonies <br></h4>
<p><code>178</code> Facilitating A Sex Offense With A Controlled Substance <br> <code>694</code> Incest <br> <code>697</code> Use Of A Child In Sexual Performance <br> <code>176</code> Sex Crimes <br> <code>180</code> Course Of Sexual Conduct Against Child <br> <code>153</code> Rape 3 <br> <code>157</code> Rape 1 <br> <code>177</code> Sexual Abuse <br> <code>168</code> Sodomy 1 <br> <code>159</code> Rape 1 Attempt <br> <code>166</code> Sodomy 2 <br> <code>164</code> Sodomy 3 <br> <code>179</code> Aggrevated Sexual Abuse <br> <code>155</code> Rape 2 <br> <code>586</code> Sextrafficking <br> <code>696</code> Promoting Sexual Performance – Child</p>
<p><br></p>
</div>
<div id="drug-related-felonies" class="section level4">
<h4>Drug-Related Felonies <br></h4>
<p><code>500</code> Controlled Substance, Possession <br> <code>501</code> Controlled Substance, Possession <br> <code>502</code> Controlled Substance, Possession <br> <code>503</code> Controlled Substance, Intent To <br> <code>505</code> Controlled Substance, Possession <br> <code>507</code> Controlled Substance, Possession <br> <code>510</code> Controlled Substance, Intent T <br> <code>512</code> Controlled Substance, Sale 1 <br> <code>514</code> Controlled Substance, Sale 2 <br> <code>515</code> Controlled Substance, Sale 3 <br> <code>519</code> Sale School Grounds 4 <br> <code>520</code> Controlled Substance, Sale 4 <br> <code>521</code> Controlled Substance, Sale 5 <br> <code>523</code> Sale School Grounds <br> <code>524</code> Controlled Substance, Possession<br> <code>529</code> Sales Of Prescription <br> <code>530</code> Drug, Injection Of <br> <code>531</code> Drug Paraphernalia, Possessesion <br> <code>532</code> Controlled Substance,Possession <br> <code>568</code> Marijuana, Possession 1, 2 &amp; 3 <br> <code>570</code> Marijuana, Sale 1, 2 &amp; 3</p>
<p><br></p>
</div>
<div id="weapons-related-felonies" class="section level4">
<h4>Weapons-Related Felonies <br></h4>
<p><code>781</code> Criminal Disposal Firearm 1 <br> <code>792</code> Weapons Possession 1 &amp; 2 <br> <code>793</code> Weapons Possession 3 <br> <code>796</code> Weapons,Prohibited Use</p>
<p><br></p>
</div>
</div>
<div id="subsetting-data" class="section level3">
<h3>Subsetting Data <br></h3>
<p>Using that information, we can subset and filter the data to provide us with our final dataset.</p>
<pre class="r"><code>#Cleaning and Filtering Data
nyc_felonies = nyc_crime %&gt;% 
  janitor::clean_names() %&gt;% 
  mutate(year = year(cmplnt_fr_dt)) %&gt;%
  mutate_if(is.character, tolower) %&gt;% 
  filter(year %in% 2014:2017) %&gt;% 
  filter(law_cat_cd == &quot;felony&quot;) %&gt;% 
  select(- station_name, - transit_district, - hadevelopt, - patrol_boro, - housing_psa, 
         - juris_desc)

#saveRDS(nyc_felonies, file = &quot;./data/nyc_felonies.rds&quot;)

#Selecting Crimes of Interest
sex_drug_weapons = nyc_felonies %&gt;% 
  
  filter(pd_cd %in% c(178, 694, 697, 176, 180, 153, 157, 177, 168, 159, 166, 164, 179, 155, 
                      586, 696, # Sex-related felonies
                      
                      ## Drug-related felonies
                      500, 501, 502, 503, 505, 507, 510, 512, 514, 515, 519, 520, 521, 523, 
                      524, 529, 530, 531, 532, 568, 570,
                      
                      ### Weapons-related felonies
                      781, 792, 793, 796)) %&gt;% 
  
  #Select Variables of Interest
  select(cmplnt_num, boro_nm, cmplnt_fr_dt, cmplnt_to_dt, cmplnt_fr_tm, ky_cd, ofns_desc, 
         pd_cd, pd_desc, vic_race, vic_sex, vic_age_group, year, prem_typ_desc) %&gt;% 
  
  #Create Classification of Felonies
  mutate(boro_nm = if_else(boro_nm == &quot;staten island&quot;, &quot;staten_island&quot;, boro_nm),
         
     crime_group = if_else(pd_cd %in% c(178, 694, 697, 176, 180, 153, 157, 177, 168, 159, 166, 
                                        164, 179, 155, 586, 696), &quot;Sex-Related&quot;, 
                               
                   if_else(pd_cd %in% c(500, 501, 502, 503, 505, 507, 510, 512, 514, 515, 519, 
                                        520, 521, 523, 524, 529, 530, 531, 532, 568, 570), 
                                        &quot;Drug-Related&quot;, 
                               
                   if_else(pd_cd %in% c(781, 792, 793, 796), &quot;Weapons-Related&quot;, pd_cd))))

#saveRDS(sex_drug_weapons, file = &quot;./data/sex_drug_weapons.rds&quot;)</code></pre>
<p><br></p>
<p>The resulting dataset has <strong>46,692 observations</strong> and <strong>14 variables</strong>.</p>
<pre class="r"><code>felonies = readRDS(file = &quot;./data/sex_drug_weapons.rds&quot;)

summary(felonies)</code></pre>
<pre><code>##   cmplnt_num          boro_nm           cmplnt_fr_dt                
##  Length:46692       Length:46692       Min.   :2014-01-01 00:00:00  
##  Class :character   Class :character   1st Qu.:2015-01-15 00:00:00  
##  Mode  :character   Mode  :character   Median :2016-01-16 00:00:00  
##                                        Mean   :2016-01-03 21:27:52  
##                                        3rd Qu.:2016-12-22 00:00:00  
##                                        Max.   :2017-12-31 00:00:00  
##                                                                     
##   cmplnt_to_dt                 cmplnt_fr_tm          ky_cd          
##  Min.   :2014-01-01 00:00:00   Length:46692       Length:46692      
##  1st Qu.:2015-02-05 00:00:00   Class :character   Class :character  
##  Median :2016-02-09 00:00:00   Mode  :character   Mode  :character  
##  Mean   :2016-01-19 07:31:50                                        
##  3rd Qu.:2017-01-08 00:00:00                                        
##  Max.   :2017-12-31 00:00:00                                        
##  NA&#39;s   :9108                                                       
##   ofns_desc            pd_cd             pd_desc         
##  Length:46692       Length:46692       Length:46692      
##  Class :character   Class :character   Class :character  
##  Mode  :character   Mode  :character   Mode  :character  
##                                                          
##                                                          
##                                                          
##                                                          
##    vic_race           vic_sex          vic_age_group           year     
##  Length:46692       Length:46692       Length:46692       Min.   :2014  
##  Class :character   Class :character   Class :character   1st Qu.:2015  
##  Mode  :character   Mode  :character   Mode  :character   Median :2016  
##                                                           Mean   :2016  
##                                                           3rd Qu.:2016  
##                                                           Max.   :2017  
##                                                                         
##  prem_typ_desc      crime_group       
##  Length:46692       Length:46692      
##  Class :character   Class :character  
##  Mode  :character   Mode  :character  
##                                       
##                                       
##                                       
## </code></pre>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
